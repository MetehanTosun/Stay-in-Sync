<p-toast></p-toast>
<div class="script-editor-container p-m-2">
  <div *ngIf="isLoading" class="loading-overlay">
    <p-progressSpinner strokeWidth="4"></p-progressSpinner>
    <p>{{ loadingMessage }}</p>
  </div>

  <p-splitter
    [style]="{ height: '80vh' }"
    styleClass="p-mb-3"
    [panelSizes]="[70, 30]"
    [class.blurred]="isLoading"
  >
    <ng-template pTemplate pTemplateType="panel">
      <div class="col-main-editor p-fluid">
        <p-panel header="TypeScript Transformation Script" styleClass="h-full editor-panel">
          <div class="monaco-wrapper">
            <ngx-monaco-editor
              style="width: 100%; height: 100%"
              [options]="editorOptions"
              [(ngModel)]="code"
              (onInit)="onEditorInit($event)"
            >
            </ngx-monaco-editor>
          </div>
          <ng-template pTemplate="footer">
            <div class="p-d-flex p-jc-end">
              <p-button
                label="Save Script"
                icon="pi pi-save"
                (click)="saveScript()"
                [loading]="isSaving"
                [disabled]="isLoading || isSaving || !syncJobId"
              ></p-button>
            </div>
          </ng-template>
        </p-panel>
      </div>
    </ng-template>
    <ng-template pTemplate pTemplateType="panel">
      <div class="col-side-panel p-fluid" style="height: 100%">
        <app-sync-job-context-panel [syncJobData]="currentSyncJobContextData">
        </app-sync-job-context-panel>
      </div>
    </ng-template>
  </p-splitter>
</div>
