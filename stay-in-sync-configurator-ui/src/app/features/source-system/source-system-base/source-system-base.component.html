<section class="systems-list">
  <div class="toolbar">
    <button
      pButton
      type="button"
      label="Create Source System"
      icon="pi pi-plus"
      (click)="openCreateDialog()">
    </button>
  </div>

  <p-dialog
    header="Create Source System"
    [(visible)]="showCreateDialog"
    [modal]="true"
    [closable]="true"
    (onHide)="onDialogClose()"
    [style]="{ width: '80vw', maxWidth: '800px', minHeight: '50vh', height: 'auto' }"
    [baseZIndex]="10000"
    class="big-dialog">
    <app-create-source-system
      *ngIf="showCreateDialog"
      (saved)="onSourceSystemSaved($event)"
      (cancelled)="onSourceSystemCancelled()">
    </app-create-source-system>
  </p-dialog>

  <!-- Liste der existierenden Source Systems mit p-table -->
  <div *ngIf="!isLoadingSystems" style="margin-top: 2rem;">
    <p-table [value]="systems" [tableStyle]="{'min-width': '60rem'}" *ngIf="systems && systems.length > 0; else noSystemsTable">
      <ng-template pTemplate="caption">
        <div class="table-header">
          Configured Source Systems
        </div>
      </ng-template>
      <ng-template pTemplate="header">
        <tr>
          <th style="width: 25%">ID</th> <!-- NEUE Spaltenüberschrift für ID -->
          <th style="width: 25%">Name</th>
          <th style="width: 15%">Type</th>
          <th>Details</th>
          <!-- Optional: Spalte für Aktionen (Bearbeiten, Löschen) -->
          <!-- <th>Actions</th> -->
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-system>
        <tr>
          <td>{{ system.id }}</td> <!-- NEUE Zelle für system.id -->
          <td>{{ system.name }}</td>
          <td>{{ system.type }}</td>
          <td>
            <span *ngIf="system.type === 'AAS'">AAS ID: {{ system.aasId }}</span>
            <span *ngIf="system.type === 'REST'">Endpoint: {{ system.endpoint }}</span>
          </td>
          <!-- Optional: Zellen für Aktionen -->
          <!--
          <td>
            <button pButton pRipple icon="pi pi-pencil" class="p-button-rounded p-button-success p-mr-2"></button>
            <button pButton pRipple icon="pi pi-trash" class="p-button-rounded p-button-warning"></button>
          </td>
          -->
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="4">No source systems configured yet.</td> <!-- colspan auf 4 erhöht -->
        </tr>
      </ng-template>
    </p-table>
    <ng-template #noSystemsTable>
      <p>No source systems configured yet. Click "Create Source System" to add one.</p>
    </ng-template>
  </div>

  <div *ngIf="isLoadingSystems" style="margin-top: 2rem;">
    <p>Loading systems...</p>
    <!-- Optional: PrimeNG Skeleton Loader für besseres UX -->
    <!--
    <p-table [value]="[{},{},{}]" [tableStyle]="{'min-width': '60rem'}">
      <ng-template pTemplate="header">
        <tr><th>ID</th><th>Name</th><th>Type</th><th>Details</th></tr>
      </ng-template>
      <ng-template pTemplate="body" let-item>
        <tr>
          <td><p-skeleton></p-skeleton></td>
          <td><p-skeleton></p-skeleton></td>
          <td><p-skeleton></p-skeleton></td>
          <td><p-skeleton></p-skeleton></td>
        </tr>
      </ng-template>
    </p-table>
    -->
  </div>
</section>