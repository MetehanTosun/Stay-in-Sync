<div class="rules-overview-container">
  <div class="header-section">
    <h2>Synchronization Rules</h2>
    <button class="create-btn" (click)="openCreateDialog()">
      ‚ûï Create new Rule
    </button>
  </div>

  @if (isLoading) {
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <p>Loading rules...</p>
    </div>
  } @else {
    <div class="rules-table-container">
      <table class="rules-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Type</th>
            <th>Polling Rate</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (rule of rules; track rule.id) {
            <tr>
              <td>{{ rule.name }}</td>
              <td>{{ rule.type }}</td>
              <td>{{ rule.pollingRate }} {{ rule.pollingUnit }}</td>
              <td>
                <div class="status-container">
                  <span class="status-badge" [class.active]="rule.isActive" [class.inactive]="!rule.isActive">
                    {{ rule.status }}
                  </span>
                  <label class="toggle-switch">
                    <input type="checkbox" [checked]="rule.isActive" (change)="toggleRuleStatus(rule)">
                    <span class="slider"></span>
                  </label>
                </div>
              </td>
              <td>
                <div class="actions">
                  <button class="action-btn edit-btn" (click)="editRule(rule.id)" title="Edit Rule">
                    üìù
                  </button>
                  <button class="action-btn delete-btn" (click)="deleteRule(rule.id)" title="Delete Rule">
                    üóëÔ∏è
                  </button>
                </div>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }

  <!-- Create Rule Dialog -->
  @if (showCreateDialog) {
    <div class="dialog-overlay" (click)="closeCreateDialog()">
      <div class="dialog-content" (click)="$event.stopPropagation()">
        <h3>Create new Rule</h3>

        <div class="form-group">
          <label for="ruleName">Name</label>
          <input
            id="ruleName"
            type="text"
            [(ngModel)]="newRule.name"
            placeholder="Demo Rule"
            class="form-input">
        </div>

        <div class="form-group">
          <label for="ruleType">Type</label>
          <select id="ruleType" class="form-select" disabled>
            <option value="Graph">Graph</option>
          </select>
        </div>

        <div class="form-group">
          <label for="pollingRate">Polling Rate</label>
          <div class="polling-rate-container">
            <input
              id="pollingRate"
              type="number"
              [(ngModel)]="newRule.pollingRate"
              min="1"
              class="form-input polling-input">
            <select [(ngModel)]="newRule.pollingUnit" class="form-select unit-select">
              <option value="Minutes">Minutes</option>
              <option value="Hours">Hours</option>
              <option value="Days">Days</option>
            </select>
          </div>
        </div>

        <div class="dialog-actions">
          <button class="btn-success" (click)="createRule()">
            üíæ Save
          </button>
          <button class="btn-cancel" (click)="closeCreateDialog()">
            ‚ùå Cancel
          </button>
        </div>
      </div>
    </div>
  }
</div>
