<div class="replay-container">
  <section class="left-pane">
    <header class="pane-header">
      <h2>Script (read-only)</h2>
      <button class="btn btn-secondary" disabled>Replay (stub)</button>
    </header>

    <ng-container *ngIf="!loading(); else loadingTpl">
      <ng-container *ngIf="!error(); else errorTpl">
        <pre class="code-block"><code>{{ scriptDisplay }}</code></pre>
      </ng-container>
    </ng-container>
  </section>

  <section class="right-pane">
    <header class="tabs">
      <button
        class="tab"
        [class.active]="activeTab === 'source'"
        (click)="setTab('source')"
      >
        SourceData
      </button>
      <button
        class="tab"
        [class.active]="activeTab === 'vars'"
        (click)="setTab('vars')"
      >
        Variables
      </button>
      <button
        class="tab"
        [class.active]="activeTab === 'term'"
        (click)="setTab('term')"
      >
        Terminal
      </button>
    </header>

    <div class="tab-content">
      <ng-container *ngIf="!loading(); else loadingTpl">
        <ng-container *ngIf="!error(); else errorTpl">
          <div *ngIf="activeTab === 'source'">
            <h3>SourceData</h3>
            <pre class="json-block">{{
              data()?.transformationResult?.sourceData | json
            }}</pre>
          </div>

          <div *ngIf="activeTab === 'vars'">
            <h3>Variable Snapshot</h3>
            <pre class="json-block">
// Not captured yet. Coming when Truffle/variable dump is integrated.</pre
            >
          </div>

          <div *ngIf="activeTab === 'term'">
            <h3>Terminal</h3>
            <pre class="terminal">{{
              data()?.transformationResult?.errorInfo || "No errors."
            }}</pre>
          </div>
        </ng-container>
      </ng-container>
    </div>
  </section>
</div>

<ng-template #loadingTpl>
  <div style="padding: 12px">Loadingâ€¦</div>
</ng-template>

<ng-template #errorTpl>
  <div style="padding: 12px; color: #b00020">{{ error() }}</div>
</ng-template>
